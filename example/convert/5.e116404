Traceback (most recent call last):
  File "/public/home/group_zyl/.conda/envs/pt200/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/public/home/group_zyl/.conda/envs/pt200/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/public/home/group_zyl/zyl/program/Equi-MPNN/__main__.py", line 1, in <module>
    import run.train
  File "/public/home/group_zyl/zyl/program/Equi-MPNN/run/train.py", line 53, in <module>
    jit_lammps=lammps.lammps(atom_species=atom_species,initpot=initpot,max_l=max_l,nwave=nwave,cutoff=cutoff,ncontract=ncontract,emb_nblock=emb_nblock,emb_nl=emb_nl,emb_layernorm=emb_layernorm,iter_loop=iter_loop,iter_nblock=iter_nblock,iter_nl=iter_nl,iter_dropout_p=iter_dropout_p,iter_layernorm=iter_layernorm,nblock=nblock,nl=nl,dropout_p=dropout_p,layernorm=layernorm)
  File "/public/home/group_zyl/zyl/program/Equi-MPNN/lammps_ANN/model/script.py", line 8, in __init__
    self.model=MPNN.MPNN(atom_species=atom_species,initpot=0.0,max_l=max_l,nwave=nwave,cutoff=cutoff,ncontract=ncontract,emb_nblock=emb_nblock,emb_nl=emb_nl,emb_layernorm=emb_layernorm,iter_loop=iter_loop,iter_nblock=iter_nblock,iter_nl=iter_nl,iter_dropout_p=iter_dropout_p,iter_layernorm=iter_layernorm,nblock=nblock,nl=nl,dropout_p=dropout_p,layernorm=layernorm)
  File "/public/home/group_zyl/zyl/program/Equi-MPNN/lammps_ANN/model/MPNN.py", line 21, in __init__
    index_l=torch.zeros(self.nangular,device=device,dtype=torch.long)
NameError: name 'device' is not defined
terminate called without an active exception
/var/spool/torque/mom_priv/jobs/116404.r740xd.SC: line 16: 43927 Aborted                 (core dumped) python3 $path > out
