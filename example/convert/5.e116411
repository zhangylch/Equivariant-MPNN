Traceback (most recent call last):
  File "/public/home/group_zyl/.conda/envs/pt200/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/public/home/group_zyl/.conda/envs/pt200/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/public/home/group_zyl/zyl/program/Equi-MPNN/__main__.py", line 1, in <module>
    import run.train
  File "/public/home/group_zyl/zyl/program/Equi-MPNN/run/train.py", line 110, in <module>
    if np.mod(iepoch,check_epoch)==0: scheduler(loss_val)
  File "/public/home/group_zyl/zyl/program/Equi-MPNN/src/scheduler.py", line 17, in __call__
    return self.forward(loss)
  File "/public/home/group_zyl/zyl/program/Equi-MPNN/src/scheduler.py", line 30, in forward
    jit_pes=torch.jit.script(self.ema_model.module)
  File "/public/home/group_zyl/.conda/envs/pt200/lib/python3.10/site-packages/torch/jit/_script.py", line 1284, in script
    return torch.jit._recursive.create_script_module(
  File "/public/home/group_zyl/.conda/envs/pt200/lib/python3.10/site-packages/torch/jit/_recursive.py", line 480, in create_script_module
    return create_script_module_impl(nn_module, concrete_type, stubs_fn)
  File "/public/home/group_zyl/.conda/envs/pt200/lib/python3.10/site-packages/torch/jit/_recursive.py", line 542, in create_script_module_impl
    script_module = torch.jit.RecursiveScriptModule._construct(cpp_module, init_fn)
  File "/public/home/group_zyl/.conda/envs/pt200/lib/python3.10/site-packages/torch/jit/_script.py", line 614, in _construct
    init_fn(script_module)
  File "/public/home/group_zyl/.conda/envs/pt200/lib/python3.10/site-packages/torch/jit/_recursive.py", line 520, in init_fn
    scripted = create_script_module_impl(orig_value, sub_concrete_type, stubs_fn)
  File "/public/home/group_zyl/.conda/envs/pt200/lib/python3.10/site-packages/torch/jit/_recursive.py", line 546, in create_script_module_impl
    create_methods_and_properties_from_stubs(concrete_type, method_stubs, property_stubs)
  File "/public/home/group_zyl/.conda/envs/pt200/lib/python3.10/site-packages/torch/jit/_recursive.py", line 397, in create_methods_and_properties_from_stubs
    concrete_type._create_methods_and_properties(property_defs, property_rcbs, method_defs, method_rcbs, method_defaults)
RuntimeError: 
all inputs of range must be ints, found Tensor in argument 1:
  File "/public/home/group_zyl/zyl/program/Equi-MPNN/low_level/sph_cal.py", line 66
            sph[7]=-self.hc_factor1*cart[0]*cart[2]
            sph[8]=self.hc_factor3*(cart[0]*cart[0]-cart[1]*cart[1])
            for l in range(3,self.max_l):
                     ~~~~~~~~~~~~~~~~~~ <--- HERE
                sph1=self.prefactor1[l]*(cart[0:1]*sph[self.yr_rev[l-1,0]]+cart[1:2]*sph[self.yr[l-1,l-1]])
                sph2=self.prefactor2[l-1]*cart[2:3]*sph[self.yr_rev[l-1,0]]

